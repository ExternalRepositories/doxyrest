<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="packet_8h" kind="file" language="C++">
    <compoundname>packet.h</compoundname>
    <includes refid="wrapper_8h" local="yes">libssh/wrapper.h</includes>
    <includedby refid="session_8h" local="yes">include/libssh/session.h</includedby>
    <includedby refid="auth_8c" local="yes">src/auth.c</includedby>
    <includedby refid="auth1_8c" local="yes">src/auth1.c</includedby>
    <includedby refid="channels_8c" local="yes">src/channels.c</includedby>
    <includedby refid="channels1_8c" local="yes">src/channels1.c</includedby>
    <includedby refid="client_8c" local="yes">src/client.c</includedby>
    <includedby refid="messages_8c" local="yes">src/messages.c</includedby>
    <includedby refid="packet_8c" local="yes">src/packet.c</includedby>
    <includedby refid="packet1_8c" local="yes">src/packet1.c</includedby>
    <includedby refid="packet__cb_8c" local="yes">src/packet_cb.c</includedby>
    <includedby refid="server_8c" local="yes">src/server.c</includedby>
    <includedby refid="session_8c" local="yes">src/session.c</includedby>
    <incdepgraph>
      <node id="424">
        <label>sys/select.h</label>
      </node>
      <node id="420">
        <label>libssh/libssh.h</label>
        <link refid="libssh_8h_source"/>
        <childnode refid="421" relation="include">
        </childnode>
        <childnode refid="422" relation="include">
        </childnode>
        <childnode refid="423" relation="include">
        </childnode>
        <childnode refid="424" relation="include">
        </childnode>
        <childnode refid="425" relation="include">
        </childnode>
        <childnode refid="426" relation="include">
        </childnode>
      </node>
      <node id="417">
        <label>include/libssh/packet.h</label>
        <link refid="packet_8h"/>
        <childnode refid="418" relation="include">
        </childnode>
      </node>
      <node id="426">
        <label>libssh/legacy.h</label>
        <link refid="legacy_8h_source"/>
      </node>
      <node id="425">
        <label>netdb.h</label>
      </node>
      <node id="423">
        <label>sys/types.h</label>
      </node>
      <node id="421">
        <label>unistd.h</label>
      </node>
      <node id="418">
        <label>libssh/wrapper.h</label>
        <link refid="wrapper_8h_source"/>
        <childnode refid="419" relation="include">
        </childnode>
        <childnode refid="420" relation="include">
        </childnode>
        <childnode refid="427" relation="include">
        </childnode>
        <childnode refid="428" relation="include">
        </childnode>
      </node>
      <node id="427">
        <label>libssh/libcrypto.h</label>
        <link refid="libcrypto_8h_source"/>
        <childnode refid="419" relation="include">
        </childnode>
      </node>
      <node id="428">
        <label>libssh/libgcrypt.h</label>
        <link refid="libgcrypt_8h_source"/>
        <childnode refid="419" relation="include">
        </childnode>
      </node>
      <node id="419">
        <label>config.h</label>
      </node>
      <node id="422">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="429">
        <label>include/libssh/packet.h</label>
        <link refid="packet_8h"/>
        <childnode refid="430" relation="include">
        </childnode>
      </node>
      <node id="431">
        <label>include/libssh/bind.h</label>
        <link refid="bind_8h_source"/>
      </node>
      <node id="432">
        <label>include/libssh/gssapi.h</label>
        <link refid="gssapi_8h_source"/>
      </node>
      <node id="430">
        <label>include/libssh/session.h</label>
        <link refid="session_8h_source"/>
        <childnode refid="431" relation="include">
        </childnode>
        <childnode refid="432" relation="include">
        </childnode>
      </node>
    </invincdepgraph>
    <innerclass refid="struct_p_a_c_k_e_t" prot="public">PACKET</innerclass>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="packet_8h_1acec1023e26d01be724eb18fa104c3b86" prot="public" static="no">
        <name>ssh_packet_state_e</name>
        <enumvalue id="packet_8h_1acec1023e26d01be724eb18fa104c3b86a1444df7be43fcfb6c1773b1e7e191340" prot="public">
          <name>PACKET_STATE_INIT</name>
          <briefdescription>
<para>Packet not initialized, must read the size of packet. </para>          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="packet_8h_1acec1023e26d01be724eb18fa104c3b86a41c80441cffae62d2fa695a1026becab" prot="public">
          <name>PACKET_STATE_SIZEREAD</name>
          <briefdescription>
<para>Size was read, waiting for the rest of data. </para>          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="packet_8h_1acec1023e26d01be724eb18fa104c3b86a41359dd99639d2309767e0d897607b53" prot="public">
          <name>PACKET_STATE_PROCESSING</name>
          <briefdescription>
<para>Full packet was read and callbacks are being called. </para>          </briefdescription>
          <detaileddescription>
<para>Future packets should wait for the end of the callback. </para>          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>different state of packet reading. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="36" column="1" bodyfile="include/libssh/packet.h" bodystart="36" bodyend="44"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="packet_8h_1a075d5e15f96818bc6fda6db72f09c878" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int packet_send</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>packet_send</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="46" column="1" bodyfile="src/packet.c" bodystart="598" bodyend="605"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a12119889d49098de21e9f348c6306eca" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_unimplemented)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_unimplemented</type>
        </param>
        <briefdescription>
<para>handles a SSH_MSG_UNIMPLEMENTED packet </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="59" column="1" bodyfile="src/packet.c" bodystart="463" bodyend="481"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1aa9b244813ff6d3c64845e6cf31354ecf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_disconnect_callback)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_disconnect_callback</type>
        </param>
        <briefdescription>
<para>Handle a SSH_DISCONNECT packet. </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="60" column="1" bodyfile="src/packet_cb.c" bodystart="48" bodyend="78"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1ae14823d082801bd94dc1bd0720da5338" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_ignore_callback)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_ignore_callback</type>
        </param>
        <briefdescription>
<para>Handle a SSH_IGNORE and SSH_DEBUG packet. </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="61" column="1" bodyfile="src/packet_cb.c" bodystart="85" bodyend="93"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1ad5d3d606b943f1dcfa3bb7fc2d157766" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_dh_reply)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_dh_reply</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="62" column="1" bodyfile="src/packet_cb.c" bodystart="95" bodyend="132"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a0b1288dcd70b5599427dade8e4c26c91" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_newkeys)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_newkeys</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="63" column="1" bodyfile="src/packet_cb.c" bodystart="134" bodyend="247"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a30ebdda521faf5818fb34111ab88e177" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_service_accept)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_service_accept</type>
        </param>
        <briefdescription>
<para>handles a SSH_SERVICE_ACCEPT packet </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="64" column="1" bodyfile="src/packet_cb.c" bodystart="254" bodyend="264"/>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga872620a8d0aa300fe01626f1aea153cd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_kexdh_init)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_kexdh_init</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="67" column="1" bodyfile="src/server.c" bodystart="174" bodyend="220"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1ad89893827ccd1b738a1a3c3ee72d3b0b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_packet_send_unimplemented</definition>
        <argsstring>(ssh_session session, uint32_t seqnum)</argsstring>
        <name>ssh_packet_send_unimplemented</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>seqnum</declname>
        </param>
        <briefdescription>
<para>sends a SSH_MSG_UNIMPLEMENTED answer to an unhandled packet </para>        </briefdescription>
        <detaileddescription>
<internal><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>session</parametername>
</parameternamelist>
<parameterdescription>
<para>the SSH session </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>seqnum</parametername>
</parameternamelist>
<parameterdescription>
<para>the sequence number of the unknown packet </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_ERROR on error, else SSH_OK </para></simplesect>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="70" column="1" bodyfile="src/packet.c" bodystart="444" bodyend="458"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a4ec4b01a4f8c4c15be76894c9837552b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_packet_parse_type</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_packet_parse_type</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<internal><para>the &quot;Type&quot; header field of a packet and updates the session </para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="71" column="1" bodyfile="src/packet.c" bodystart="486" bodyend="500"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1af53b16a51c1fb0b3cd7c15baba882ed8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_packet_socket_callback</definition>
        <argsstring>(const void *data, size_t len, void *user)</argsstring>
        <name>ssh_packet_socket_callback</name>
        <param>
          <type>const void *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>len</declname>
          <defname>receivedlen</defname>
        </param>
        <param>
          <type>void *</type>
          <declname>user</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<internal><para>a data received event. It then calls the handlers for the different packet types or and exception handler callback. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>user</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to current ssh_session </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to the data received  length of data received. It might not be enough for a complete packet </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>number of bytes read and processed. </para></simplesect>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="74" column="1" bodyfile="src/packet.c" bodystart="142" bodyend="361"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1aca955bacc5c633c212bdb61e1b43a1a2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_packet_register_socket_callback</definition>
        <argsstring>(ssh_session session, struct ssh_socket_struct *s)</argsstring>
        <name>ssh_packet_register_socket_callback</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>struct ssh_socket_struct *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="75" column="1"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a6799ed6886c75279d61dcacd83b71102" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_packet_set_callbacks</definition>
        <argsstring>(ssh_session session, ssh_packet_callbacks callbacks)</argsstring>
        <name>ssh_packet_set_callbacks</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>ssh_packet_callbacks</type>
          <declname>callbacks</declname>
        </param>
        <briefdescription>
<para>sets the callbacks for the packet layer </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="76" column="1" bodyfile="src/packet.c" bodystart="375" bodyend="382"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a2e88eac5d0547fdb7f03830adce9c4d2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_packet_set_default_callbacks</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_packet_set_default_callbacks</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>sets the default packet handlers </para>        </briefdescription>
        <detaileddescription>
<internal></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="77" column="1" bodyfile="src/packet.c" bodystart="387" bodyend="399"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a2aab95b1998dbe9a6c525ba265768f52" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_packet_process</definition>
        <argsstring>(ssh_session session, uint8_t type)</argsstring>
        <name>ssh_packet_process</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>type</declname>
        </param>
        <briefdescription>
<para>dispatch the call of packet handlers callbacks for a received packet </para>        </briefdescription>
        <detaileddescription>
<internal><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>type</parametername>
</parameternamelist>
<parameterdescription>
<para>type of packet </para></parameterdescription>
</parameteritem>
</parameterlist>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="78" column="1" bodyfile="src/packet.c" bodystart="405" bodyend="436"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a5e792f71fd551bf331ef46a13fd97144" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t packet_decrypt_len</definition>
        <argsstring>(ssh_session session, char *crypted)</argsstring>
        <name>packet_decrypt_len</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>crypted</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="81" column="1" bodyfile="src/packet_crypt.c" bodystart="47" bodyend="58"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a83fa3a0f1f2ec8978eef0e9bab8710dc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int packet_decrypt</definition>
        <argsstring>(ssh_session session, void *packet, unsigned int len)</argsstring>
        <name>packet_decrypt</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>packet</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>len</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="82" column="1"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1a83fccd68817bed1c01015472aea9c807" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>unsigned char *</type>
        <definition>unsigned char* packet_encrypt</definition>
        <argsstring>(ssh_session session, void *packet, unsigned int len)</argsstring>
        <name>packet_encrypt</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>packet</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>len</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="83" column="1"/>
      </memberdef>
      <memberdef kind="function" id="packet_8h_1af1c50c6236cba2cd2f2f95ce3f845706" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int packet_hmac_verify</definition>
        <argsstring>(ssh_session session, ssh_buffer buffer, unsigned char *mac, enum ssh_hmac_e type)</argsstring>
        <name>packet_hmac_verify</name>
        <param>
          <type>ssh_session</type>
          <declname>session</declname>
        </param>
        <param>
          <type>ssh_buffer</type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>unsigned char *</type>
          <declname>mac</declname>
        </param>
        <param>
          <type>enum ssh_hmac_e</type>
          <declname>type</declname>
        </param>
        <briefdescription>
<para>Verify the hmac of a packet. </para>        </briefdescription>
        <detaileddescription>
<internal><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>session</parametername>
</parameternamelist>
<parameterdescription>
<para>The session to use. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>buffer</parametername>
</parameternamelist>
<parameterdescription>
<para>The buffer to verify the hmac from. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>mac</parametername>
</parameternamelist>
<parameterdescription>
<para>The mac to compare with the hmac.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 if hmac and mac are equal, &lt; 0 if not or an error occurred. </para></simplesect>
</para></internal>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/libssh/packet.h" line="86" column="1" bodyfile="src/packet_crypt.c" bodystart="163" bodyend="191"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <location file="include/libssh/packet.h"/>
  </compounddef>
</doxygen>
